{% extends "base.html" %}
{% block title %}Students{% endblock %}
{% block content %}
<h2 class="mb-3">Students</h2>

<div class="row g-3">
  <!-- Create -->
  <div class="col-lg-6">
    <div class="card text-bg-dark border-secondary">
      <div class="card-header">Nieuwe student</div>
      <div class="card-body">
        <form method="post" action="{{ url_for('web.students_create') }}" class="row g-2">
          <div class="col-4">
            <label class="form-label">Studentnummer</label>
            <input name="studentnummer" class="form-control" required maxlength="20">
          </div>
          <div class="col-4">
            <label class="form-label">Voornaam</label>
            <input name="voornaam" class="form-control" required>
          </div>
          <div class="col-4">
            <label class="form-label">Achternaam</label>
            <input name="achternaam" class="form-control" required>
          </div>
          <div class="col-6">
            <label class="form-label">Inschrijfdatum</label>
            <input type="date" name="inschrijfdatum" class="form-control">
          </div>
          <div class="col-6">
            <label class="form-label">Opleiding</label>
            <select name="opleiding_id" class="form-select">
              <option value="">—</option>
              {% for o in opleidingen %}
                <option value="{{ o._id }}">{{ o.naam }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-12">
            <button class="btn btn-primary">Opslaan</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- List -->
  <div class="col-lg-6">
    <div class="card text-bg-dark border-secondary">
      <div class="card-header">Lijst</div>
      <div class="card-body p-0">
        <table class="table table-dark table-striped table-hover mb-0">
          <thead>
            <tr>
              <th>Studentnr</th><th>Naam</th><th>Opleiding</th><th class="text-end">Acties</th>
            </tr>
          </thead>
          <tbody>
          {% for s in students %}
            <tr>
              <td>{{ s.studentnummer or s['studentnummer'] }}</td>
              <td>
                <a class="link-light" href="{{ url_for('web.student_detail', id=s['_id']) }}">
                  {{ s.achternaam or s['achternaam'] }}, {{ s.voornaam or s['voornaam'] }}
                </a>
              </td>
              <td>{{ opleidings_map.get(s.opleiding_id, "—") }}</td>
              <td class="text-end">
                <form method="post" action="{{ url_for('web.students_delete', id=s['_id']) }}" onsubmit="return confirm('Verwijderen?')">
                  <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                </form>
              </td>
            </tr>
          {% else %}
            <tr><td colspan="4" class="text-center text-secondary">Geen studenten</td></tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
